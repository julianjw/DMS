<div id='searchD'>
	<table border=0>
	<tr>
		<td>
			<label for='queryT' id='queryL' class='toggle'>ID: </label>
			<input type='text' name='queryT' id='queryT' />
			<button id='queryB'>Search</button>
	
			<div id='searchResults'></div>
		</td>
	</tr>
	</table>
</div>

<script type='text/javascript'>

function selectPP(el) {
	
	//get the personal plan of the selected client
	
	var a = function(callback)
	{
	
		//pull details
		$.ajax({
			url: "./rest/personalplan/" + $.cookie('user_id') + "/" + $.cookie('auth_token') + "/" + $(el).attr("id"),
			type:"get",
			contentType: "application/json",
			async: false,
			success: callback, //synchronous request (wait for data to be returned before creating pdf)
			error: function(xhr) {
				// do something to handle error
				
			}
		});
	};
	
	a(function(data) {
		console.log(data); //outputing json object into console
		
		//Create the PDF
		alert("PDF Being Generated"); //testing only
		
		//Create today's date
		var d =  new Date();
		var month = d.getMonth()+1;
		var day = d.getDate();
		var date = ((''+day).length<2 ? '0' : '') + day + '/' + ((''+month).length<2 ? '0' : '') + month + '/' + d.getFullYear();
			
		//do shit (add shit to pdf)
		var doc = new jsPDF();
		
		//set document properties
		doc.setProperties({
			title: data.clientDetails.personalDetails.preferredName +  ' Personal Plan', 
			subject: 'Client Personal Plan',
			author: $.cookie('user_id'),
		});
		
		//Personal plan title centered
		doc.setFontType("bold");
		doc.setFontSize(22);
		doc.text(85, 10, 'Personal Plan');
		
		/* -------------------------------- CLIENT DETAILS --------------------------------------*/
		doc.setFontSize(18);
		doc.text(10, 15, 'Client Details');
		//Personal details
		doc.setFontSize(16);
		doc.text(10, 20, 'Personal Details');
		doc.setFontType("normal"); //set font type back to normal
		doc.setFontSize(14);
		doc.text(10, 25, 'Creation Date: ' + data.clientDetails.personalDetails.creationDate);
		doc.text(10, 30, 'Preferred Name: ' + data.clientDetails.personalDetails.preferredName);
		doc.text(10, 35, 'Review Date: ' + data.clientDetails.personalDetails.reviewDate);
		doc.text(10, 40, 'Date of Birth: ' + data.clientDetails.personalDetails.dob);
		doc.text(10, 45, 'Email Address: ' + data.clientDetails.personalDetails.email);
		doc.text(10, 50, 'Phone Number: ' + data.clientDetails.personalDetails.phoneNumber);
		doc.text(10, 55, 'Mobile Number: ' + data.clientDetails.personalDetails.mobileNumber);
		//Alert information
		doc.setFontType("bold");
		doc.setFontSize(16);
		doc.text(10, 65, 'Alert Information');
		doc.setFontType("normal");
		doc.setFontSize(14);
		doc.text(10, 70, 'Allergies: ' +  data.clientDetails.alertInformation.allergies);
		doc.text(10, 75, 'Complex Support Needs: ' +  data.clientDetails.alertInformation.complexSupportNeeds);
		doc.text(10, 80, 'Eating Alerts: ' +  data.clientDetails.alertInformation.eatingAlerts);
		doc.text(10, 85, 'Guardian Orders: ' +  data.clientDetails.alertInformation.guardianOrders);
		doc.text(10, 90, 'Medical Issues: ' +  data.clientDetails.alertInformation.medIssues);
		doc.text(10, 95, 'Other Info: ' +  data.clientDetails.alertInformation.otherInfo);
		doc.text(10, 100, 'Phobias: ' +  data.clientDetails.alertInformation.phobias);
		doc.text(10, 105, 'Restrictive: ' +  data.clientDetails.alertInformation.restrictive);
		doc.text(10, 110, 'Safety Concerns: ' +  data.clientDetails.alertInformation.safetyConcerns);
		
		//Formal orders
		doc.setFontType("bold");
		doc.setFontSize(16);
		doc.text(10, 120, 'Formal Orders');
		doc.setFontType("normal"); 
		doc.setFontSize(14);
		doc.text(10, 125, 'Appointee: ' + data.clientDetails.formalOrders.appointee);
		doc.text(10, 130, 'Commence Date: ' + data.clientDetails.formalOrders.commenceDate);
		doc.text(10, 135, 'Contact Arrangement: ' + data.clientDetails.formalOrders.contactArrangement);
		doc.text(10, 140, 'Details: ' + data.clientDetails.formalOrders.details);
		doc.text(10, 145, 'Family Contact: ' + data.clientDetails.formalOrders.familyContact);
		doc.text(10, 150, 'Justice Requirements: ' + data.clientDetails.formalOrders.justiceRequirements);
		doc.text(10, 155, 'Order For: ' + data.clientDetails.formalOrders.orderFor);
		doc.text(10, 160, 'Order Location: ' + data.clientDetails.formalOrders.orderLocation);
		doc.text(10, 165, 'Other Information: ' + data.clientDetails.formalOrders.otherInfo);
		doc.text(10, 170, 'Protection Order: ' + data.clientDetails.formalOrders.protectionOrder);
		doc.text(10, 175, 'Special Conditions: ' + data.clientDetails.formalOrders.specialConditions);
		doc.text(10, 180, 'Child Support Officer: ' + data.clientDetails.formalOrders.childSupportOfficer);
		doc.text(10, 185, 'Visitor Information: ' + data.clientDetails.formalOrders.visitorInfo);
		
		//Living arrangements
		doc.setFontType("bold");
		doc.setFontSize(16);
		doc.text(10, 195, 'Living Arrangements');
		doc.setFontType("normal");
		doc.setFontSize(14);
		doc.text(10, 200, 'Address: ');
		doc.text(31, 200, data.clientDetails.livingArangements.houseNumber + ' '
						+ data.clientDetails.livingArangements.street);
		doc.text(31, 205, data.clientDetails.livingArangements.suburb);
		doc.text(31, 210, data.clientDetails.livingArangements.city + ', '
						+ data.clientDetails.livingArangements.postCode);		
		doc.text(10, 215, 'Service: ' + data.clientDetails.livingArangements.service);
		
		//Add this stuff in when steven has added them into the personal plan (in database but coming back in json object)
 		//doc.text(10, 220, 'Family Contact: ' + data.clientDetails.livingArangements.familyContact);
		//doc.text(10, 225, 'Sick Contact: ' + data.clientDetails.livingArangements.sickContact);
		//doc.text(10, 230, 'Other Important People: ' + data.clientDetails.livingArangements.otherImportantPeople);

		doc.addPage(); //add new page
		
		/* -------------------------------- HEALTH DETAILS --------------------------------------*/
		doc.setFontSize(18);
		doc.setFontType("bold");
		doc.text(10, 10, 'Health Details');
		//Dietary requirements
		doc.setFontSize(16);
		doc.text(10, 15, 'Dietary Requirements');
		doc.setFontType("normal");
		doc.setFontSize(14);
		doc.text(10, 20, 'Assessment Done: ' + data.healthDetails.dietaryRequirements.assessmentDone);
		doc.text(10, 25, 'Avoid Food: ' + data.healthDetails.dietaryRequirements.avoidFood);
		doc.text(10, 30, 'Breakfast: ' + data.healthDetails.dietaryRequirements.breakfast);
		doc.text(10, 35, 'Cannot Eat: ' + data.healthDetails.dietaryRequirements.cannotEat);
		doc.text(10, 40, 'Dinner: ' + data.healthDetails.dietaryRequirements.dinner);
		doc.text(10, 45, 'Dislikes: ' + data.healthDetails.dietaryRequirements.dislikes);
		doc.text(10, 50, 'Eating Support: ' + data.healthDetails.dietaryRequirements.eatingSupport);
		doc.text(10, 55, 'Location: ' + data.healthDetails.dietaryRequirements.location);
		doc.text(10, 60, 'Lunch: ' + data.healthDetails.dietaryRequirements.lunch);
		doc.text(10, 65, 'Other Information: ' + data.healthDetails.dietaryRequirements.otherInfo);
		doc.text(10, 70, 'Snacks: ' + data.healthDetails.dietaryRequirements.snacks);
		doc.text(10, 75, 'Drinking Support: ' + data.healthDetails.dietaryRequirements.supportDrinking);
		doc.text(10, 80, 'Usual Diet: ' + data.healthDetails.dietaryRequirements.usualDiet);
		
		//Health information
		doc.setFontType("bold");
		doc.setFontSize(16);
		doc.text(10, 90, 'Health Information');
		doc.setFontType("normal");
		doc.setFontSize(14);
		doc.text(10, 95, 'Additional Info: ' +  data.healthDetails.healthInformation.additionalInfo);
		doc.text(10, 100, 'Assistance With Meds: ' +  data.healthDetails.healthInformation.assistanceWithMedication);
		doc.text(10, 105, 'Conditions: ' +  data.healthDetails.healthInformation.conditions);
		doc.text(10, 110, 'History: ' +  data.healthDetails.healthInformation.historyAndInfo);
		doc.text(10, 115, 'Self Medicate: ' +  data.healthDetails.healthInformation.selfMedicate);
		doc.text(10, 120, 'Take Medication: ' +  data.healthDetails.healthInformation.takeMedication);
		
		
		//Health management
		doc.setFontType("bold");
		doc.setFontSize(16);
		doc.text(10, 130, 'Health Management');
		doc.setFontType("normal");
		doc.setFontSize(14);
		doc.text(10, 135, 'Duration: ' +  data.healthDetails.healthManagement.duration);
		doc.text(10, 140, 'Frequency: ' +  data.healthDetails.healthManagement.frequency);
		doc.text(10, 145, 'Medical Condition: ' +  data.healthDetails.healthManagement.medicalCondition);
		doc.text(10, 150, 'Precurser: ' +  data.healthDetails.healthManagement.precurser);
		doc.text(10, 155, 'Seziure Brief: ' +  data.healthDetails.healthManagement.seizureBrief);
		doc.text(10, 160, 'Seizure Non-Brief: ' +  data.healthDetails.healthManagement.seizureNonBrief);
		doc.text(10, 165, 'Staff Response: ' +  data.healthDetails.healthManagement.staffResponse);
		doc.text(10, 170, 'Symptom: ' +  data.healthDetails.healthManagement.symptom);
		doc.text(10, 175, 'Symptom Avoidance: ' +  data.healthDetails.healthManagement.symptomAvoidance);
		
		
		/* -------------------------------- COMMUNICATION --------------------------------------*/
		doc.setFontType("bold");
		doc.setFontSize(18);
		doc.text(10, 185, 'Communication');
		doc.setFontType("normal");
		doc.setFontSize(14);
		doc.text(10, 190, 'Dislikes: ' + data.communication.comsAndDecisionMaking.dislikes);
		doc.text(10, 195, 'Good Topics: ' + data.communication.comsAndDecisionMaking.goodTopics);
		doc.text(10, 200, 'I Communicate: ' + data.communication.comsAndDecisionMaking.iCommunicate);
		doc.text(10, 205, 'Independant Decisions: ' + data.communication.comsAndDecisionMaking.independantDecisions);
		doc.text(10, 210, 'Likes: ' + data.communication.comsAndDecisionMaking.likes);
		doc.text(10, 215, 'Support Me By: ' + data.communication.comsAndDecisionMaking.supportMeBy);
		doc.text(10, 220, 'Support People: ' + data.communication.comsAndDecisionMaking.supportPeople);
		doc.text(10, 225, 'You Communicate: ' + data.communication.comsAndDecisionMaking.youCommunicate);
		
		doc.addPage(); //add new page
				
		/* ------------------------- EDUCATION EMPLOYMENT --------------------------------------- */
		
		doc.setFontType("bold");
		doc.setFontSize(18);
		doc.text(10, 10, 'Education and Employment');
		//Education
		doc.setFontSize(16);
		doc.text(10, 15, 'Education');
		doc.setFontType("normal");
		doc.setFontSize(14);
		doc.text(10, 20, 'Address: ' + data.educationEmployment.education.address);
		doc.text(10, 25, 'Community Assistance: ' + data.educationEmployment.education.communityAssistance);
		doc.text(10, 30, 'Contact Person: ' + data.educationEmployment.education.contactPerson);
		doc.text(10, 35, 'Education Support Plan: ' + data.educationEmployment.education.eduSupportPlan);
		doc.text(10, 40, 'Enrolled Course: ' + data.educationEmployment.education.enrolledCourse);
		doc.text(10, 45, 'Instution Name: ' + data.educationEmployment.education.institutionName);
		doc.text(10, 50, 'Liaison: ' + data.educationEmployment.education.liaison);
		doc.text(10, 55, 'Other Support Required: ' + data.educationEmployment.education.otherSupportRequired);
		doc.text(10, 60, 'Study Support: ' + data.educationEmployment.education.studySupport);
		doc.text(10, 65, 'Support Persons: ' + data.educationEmployment.education.supportPersons);
		doc.text(10, 70, 'Teacher: ' + data.educationEmployment.education.teacher);
		
		//Employment
		doc.setFontType("bold");
		doc.setFontSize(16);
		doc.text(10, 80, 'Employment');
		doc.setFontType("normal");
		doc.setFontSize(14);
		doc.text(10, 85, 'Address: ' + data.educationEmployment.employment.address);
		doc.text(10, 90, 'Annual Leave: ' + data.educationEmployment.employment.annualLeave);
		doc.text(10, 95, 'Arrangements: ' + data.educationEmployment.employment.arrangements);
		doc.text(10, 100, 'Contact Person: ' + data.educationEmployment.employment.contactPerson);
		doc.text(10, 105, 'Employer: ' + data.educationEmployment.employment.employer);
		doc.text(10, 110, 'Equipment: ' + data.educationEmployment.employment.equipment);
		doc.text(10, 115, 'Position: ' + data.educationEmployment.employment.position);
		doc.text(10, 120, 'Sick Leave: ' + data.educationEmployment.employment.sickLeave);
		doc.text(10, 125, 'Transport: ' + data.educationEmployment.employment.transport);
		
		/* --------------------------- PLANNING ------------------------------------------------- */
		doc.setFontType("bold");
		doc.setFontSize(18);
		doc.text(10, 135, 'Planning');
		//Holiday plan
		doc.setFontSize(16);
		doc.text(10, 140, 'Holiday Plan');
		doc.setFontType("normal");
		doc.setFontSize(14);
		doc.text(10, 145, 'Holiday Type: ' + data.planning.holidayPlan.holidayType);
		doc.text(10, 150, 'Details and Info: ' + data.planning.holidayPlan.detailsAndInfo);
		doc.text(10, 155, 'How, Who and Where: ' + data.planning.holidayPlan.howWhoWhere);
		doc.text(10, 160, 'Resources Required: ' + data.planning.holidayPlan.resourcesRequired);
		doc.text(10, 165, 'Strategies: ' + data.planning.holidayPlan.strategies);
		doc.text(10, 170, 'Timeframes: ' + data.planning.holidayPlan.timeframes);
		
		//Goal plan
		doc.setFontType("bold");
        doc.setFontSize(16);
		doc.text(10, 180, 'Goal Plan');
		doc.setFontType("normal");
		doc.setFontSize(14);
		doc.text(10, 185, 'Goal to Achieve: ' + data.planning.goalPlan.goalToAchieve);
		doc.text(10, 190, 'How, Who and Where: ' + data.planning.goalPlan.howWhoWhere);
		doc.text(10, 195, 'Outcomes: ' + data.planning.goalPlan.outcomes);
		doc.text(10, 200, 'Resouces Required: ' + data.planning.goalPlan.resourcesRequired);
		doc.text(10, 205, 'Strategies: ' + data.planning.goalPlan.strategies);
		doc.text(10, 210, 'Timeframes: ' + data.planning.goalPlan.timeframes);
		
		doc.addPage(); //add new page
		
		/* ---------------------- SUPPORT REQUIRED ---------------------------------------------- */
		doc.setFontType("bold");
		doc.setFontSize(18);
		doc.text(10, 10, 'Support Required');
		//General support
		doc.setFontSize(16);
		doc.text(10, 15, 'General Support');
		doc.setFontType("normal");
		doc.setFontSize(14);
		doc.text(10, 20, 'Crowd Safety: ' + data.supportRequired.generalSupport.crowdSafety);
		doc.text(10, 25, 'Stranger Danger: ' + data.supportRequired.generalSupport.strangerDanger);
		doc.text(10, 30, 'Money Handling: ' + data.supportRequired.generalSupport.moneyHandling);
		doc.text(10, 35, 'Crowds: ' + data.supportRequired.generalSupport.crowds);
		doc.text(10, 40, 'Social Networks: ' + data.supportRequired.generalSupport.socialNetworks);
		doc.text(10, 45, 'Communications: ' + data.supportRequired.generalSupport.communications);
		doc.text(10, 50, 'Eating Out: ' + data.supportRequired.generalSupport.eatingOut);
		doc.text(10, 55, 'Beliefs: ' + data.supportRequired.generalSupport.beliefs);
		doc.text(10, 60, 'Leisure: ' + data.supportRequired.generalSupport.leisure);
		doc.text(10, 65, 'Using Appliances: ' + data.supportRequired.generalSupport.usingApplicances);
		doc.text(10, 70, 'Using Chemical: ' + data.supportRequired.generalSupport.usingChemical);
		doc.text(10, 75, 'Hazard Recognition: ' + data.supportRequired.generalSupport.hazardRecognition);
		doc.text(10, 80, 'Other Safety Info: ' + data.supportRequired.generalSupport.otherSafetyInfo);
	
		//mobility and transport
		doc.setFontType("bold");
		doc.setFontSize(16);
		doc.text(10, 90, 'Mobility and Transport');
		doc.setFontType("normal");
		doc.setFontSize(14);
		doc.text(10, 95, 'Height: ' + data.supportRequired.mobilityAndTransport.height);
		doc.text(10, 100, 'Lifts and Escalators: ' + data.supportRequired.mobilityAndTransport.liftsAndEscalators);
		doc.text(10, 105, 'Mobility Aids: ' + data.supportRequired.mobilityAndTransport.mobilityAids);
		doc.text(10, 110, 'Other Travel Support: ' + data.supportRequired.mobilityAndTransport.otherTravelSupport);
		doc.text(10, 115, 'Public Transport: ' + data.supportRequired.mobilityAndTransport.publicTransport);
		doc.text(10, 120, 'Road Safety Skills: ' + data.supportRequired.mobilityAndTransport.roadSafetySkills);
		doc.text(10, 125, 'Travel Preferences: ' + data.supportRequired.mobilityAndTransport.travelPreferences);
		doc.text(10, 130, 'Uneven Surfaces: ' + data.supportRequired.mobilityAndTransport.unevenSurfaces);
		
		//financial support
		doc.setFontType("bold");
		doc.setFontSize(16);
		doc.text(10, 140, 'Financial Support');
		doc.setFontType("normal");
		doc.setFontSize(14);
		doc.text(10, 145, 'Budget Bills: ' + data.supportRequired.financialSupport.budgetBills); 
		doc.text(10, 150, 'Budget Constraint Goal: ' + data.supportRequired.financialSupport.budgetConstraintGoal);
		doc.text(10, 155, 'Budget Emergency: ' + data.supportRequired.financialSupport.budgetEmergency);
		doc.text(10, 160, 'Budget Expenditure: ' + data.supportRequired.financialSupport.budgetExpend);
		doc.text(10, 165, 'Budget Groceries: ' + data.supportRequired.financialSupport.budgetGroceries);
		doc.text(10, 170, 'Budget House: ' + data.supportRequired.financialSupport.budgetHouse);
		doc.text(10, 175, 'Budget Support Network: ' + data.supportRequired.financialSupport.budgetSupportNetwork);
		doc.text(10, 180, 'Budget Transport: ' + data.supportRequired.financialSupport.budgetTransport);
		doc.text(10, 185, 'Budget Utilities: ' + data.supportRequired.financialSupport.budgetUtilities);
		doc.text(10, 190, 'Budgeting: ' + data.supportRequired.financialSupport.budgeting);
		doc.text(10, 195, 'Financial Admin: ' + data.supportRequired.financialSupport.financialAdmin);
		doc.text(10, 200, 'Money Handling Support: ' + data.supportRequired.financialSupport.moneyHandlingSupport);
		doc.text(10, 205, 'Other Requirements: ' + data.supportRequired.financialSupport.otherRequirements);
		doc.text(10, 210, 'Personal Items Support: ' + data.supportRequired.financialSupport.personalItemsSupport);
		
		doc.addPage(); //add new page
		
		//Daily activities
		doc.setFontType("bold");
		doc.setFontSize(16);
		doc.text(10, 10, 'Daily Activities');
		doc.setFontType("normal");
		doc.setFontSize(14);
		doc.text(10, 15, 'Bathing: ' + data.supportRequired.dailyActivities.bathing);
		doc.text(10, 20, 'Bedtime: ' + data.supportRequired.dailyActivities.bedTime);
		doc.text(10, 25, 'Cleaning: ' + data.supportRequired.dailyActivities.cleaning);
		doc.text(10, 30, 'Cooking: ' + data.supportRequired.dailyActivities.cooking);
		doc.text(10, 35, 'Dressing: ' + data.supportRequired.dailyActivities.dressing);
		doc.text(10, 40, 'Friday: ' + data.supportRequired.dailyActivities.friday);
		doc.text(10, 45, 'Menstruation: ' + data.supportRequired.dailyActivities.menstruation);
		doc.text(10, 50, 'Monday: ' + data.supportRequired.dailyActivities.monday);
		doc.text(10, 55, 'Other Things: ' + data.supportRequired.dailyActivities.otherThings);
		doc.text(10, 60, 'Routine Afternoon: ' + data.supportRequired.dailyActivities.routineAfternoon);
		doc.text(10, 65, 'Routine Mealtime: ' + data.supportRequired.dailyActivities.routineMealTime);
		doc.text(10, 70, 'Routine Morning: ' + data.supportRequired.dailyActivities.routineMorning);
		doc.text(10, 75, 'Routine Sleeping: ' + data.supportRequired.dailyActivities.routineSleeping);
		doc.text(10, 80, 'Routine Weekend: ' + data.supportRequired.dailyActivities.routineWeekend);
		doc.text(10, 85, 'Saturday: ' + data.supportRequired.dailyActivities.saturday);
		doc.text(10, 90, 'Sleeping: ' + data.supportRequired.dailyActivities.sleeping);
		doc.text(10, 95, 'Sunday: ' + data.supportRequired.dailyActivities.sunday);
		doc.text(10, 100, 'Thursday: ' + data.supportRequired.dailyActivities.thursday);
		doc.text(10, 105, 'Toileting: ' + data.supportRequired.dailyActivities.toileting);
		doc.text(10, 110, 'Tuesday: ' + data.supportRequired.dailyActivities.tuesday);
		doc.text(10, 115, 'Wednesday: ' + data.supportRequired.dailyActivities.wednesday);
	
		//relaxation
		doc.setFontType("bold");
		doc.setFontSize(16);
		doc.text(10, 125, 'Relaxation');
		doc.setFontType("normal");
		doc.setFontSize(14);
		doc.text(10, 130, 'Activities: ' + data.supportRequired.relaxation.activities);
		doc.text(10, 135, 'Movie: ' + data.supportRequired.relaxation.movie);
		doc.text(10, 140, 'Music: ' + data.supportRequired.relaxation.music);
		doc.text(10, 145, 'Other Activities: ' + data.supportRequired.relaxation.otherActivities);
		doc.text(10, 150, 'TV Show: ' + data.supportRequired.relaxation.tVShow);
			
		//Prompt the user to save the pdf
		doc.save($(el).attr("id") + '_personal_plan' + date + '.pdf');
	});

}


$(document).ready(function(){
	
	//page loads
	//get list of existing clients
	$.ajax({
		url: "./rest/personalplan/allclientswithplans/" + $.cookie('user_id') + "/" + $.cookie('auth_token'),
		type:"get",
		contentType: "application/json",
		success: function(d) {
			$("#searchResults").html("");
			var content = "<table>"
			content += "<tr><th>Client ID</th><th>Name</th><th>DOB</th><th>Mobile</th><th>Telephone</th></tr>";
			for (var i = 0; i < d.existingPlanDetails.length; i++) {
				content += "<tr><td class='fakeLink' id='" + d.existingPlanDetails[i].user_id + "'onClick='selectPP(this);'>" + d.existingPlanDetails[i].user_id + "</td>";
				content += "<td>" + d.existingPlanDetails[i].rName + "</td>";
				content += "<td>" + d.existingPlanDetails[i].dob + "</td>";
				content += "<td>" + d.existingPlanDetails[i].mobile + "</td>";
				content += "<td>" + d.existingPlanDetails[i].telephone + "</td></tr>";
			}
			content += "</table>";
			$("#searchResults").append(content);
		},
		error: function(xhr) {
			// do something to handle error
			alert("error getting existing personal plan details");
		}
	});
	
	
	//click on search button
	$("#queryB").click(function(){
		$.ajax({
			url: "./rest/personalplan/allclientswithplans/" + $.cookie('user_id') + "/" + $.cookie('auth_token'),
			type:"get",
			contentType: "application/json",
			success: function(d) {
				$("#searchResults").html("");
				var content = "<table>"
				content += "<tr><th>Client ID</th><th>Name</th><th>DOB</th><th>Mobile</th><th>Telephone</th></tr>";
				for (var i = 0; i < d.existingPlanDetails.length; i++) {
					if(d.existingPlanDetails[i].user_id == $("#queryT").val() || $("#queryT").val()=="") {
						content += "<tr><td>" + d.existingPlanDetails[i].user_id + "</td>";
						content += "<td>" + d.existingPlanDetails[i].rName + "</td>";
						content += "<td>" + d.existingPlanDetails[i].dob + "</td>";
						content += "<td>" + d.existingPlanDetails[i].mobile + "</td>";
						content += "<td>" + d.existingPlanDetails[i].telephone + "</td></tr>";
					}
				}
				content += "</table>";
				$("#searchResults").append(content);
			},
			error: function(xhr) {
				// do something to handle error
				alert("error getting existing personal plan details");
			}
		});
	});
});
</script>